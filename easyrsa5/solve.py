import gmpy2

# 假设已知的三对 (n, c)
n1 = 10256130058275655830488031920465885128421290884493232641785438342004335682420203521313857881525404338312898461203087746526934825891296526658513296139544193679845726105481115968920853671518433548349006827650322983569601327515948610151743212113126847067674922296152762633842814836279952169020441058531336286542463617368862329921871179709400507681394373629617745305537616392328158108235533235365602918821582696943326207074948319471296971108528795058779490067296526800713392761368195225129900089643292021618063793317365199815089558781197828806231859862396250927314598896375132910232014824208896622424736679658766887817401 # 第一次加密的n
c1 = 5507446216880917455462986489650261956301468877547432802130520031412839216535657779413177203125680342007742717021317723658728367984167580557768480248356644886233992803250502940306862707504025474593016768629786360864326235789499984217028266913595154263818377333592891167255297227636407842596395236777128844380892790285971246316812253738182860134415359799876446780829412729638583306360182550835438433245134309547159915847584792074034290675737940971731871711439015937686472475388074953779468870933842620884043621250798717170751349869832339163188944678820106139974943434340377783874809925817476704262229926780378472381264 # 第一次加密的c
n2 = 15357578724599441993052401751254651768481226024360438680042082688746744984656195498564049585286967649904438731805537194327459563805608835272799188739485382895816810453745538422540704119249871226712213262980469497039696882878442369221975896449360553423927481112986022428753102255139680939078284320066019619106489955079569365075102141410117191999624242236715626529105212619597823105703253424578180923198518367950314590659193307930554264397093925775827042236176268007759803582690137843840980772386705480164449778083483285188291484676381242507814851169263482260203814644716543083180451405668819072808330429718567506062709 # 第二次加密的n
c2 = 610128496841462726317506833425685643376834477248581421936289767191157231169877273183670135484878362728645097146468409759041600018012537864965547811439857448464828540773235726178920818294827674781948113255623633839285430654248748870253648833070499790126380247202207754889468929052915267409652159437633870989343563581051402656368193984289733650178890073336193074539112885382859827344976118474202079130801988013675989748389416639822638361617695956152724949838018366316114995037607804462136201579832417071595352634765191415200245101123286308956900978729673956327795478929511443812164927929050130648551821651470507368915 # 第二次加密的c
n3 = 15706573883662793739180426124824346478737100750556689571302762666876649831280571602948746690262778388942314949908911977727419329827787818300535881483619026949045102356233720193077375483188473492311257521059754651024634417328380269412960158500971730983460808989304694429812828742240003652685953972610313471058677277924211777470659070571788912136262813207526510546671118755260943383957825959169657967941446137557170285428705475456867454692625170389547696471536617998814182521062823270091563374756300824962495253118280758541061585938613014265436520554086744112978557060027701878804415916848369237236060118599601808527041 # 第三次加密的n
c3 = 14732860321673314016181562632739555343415389097691339548188061768789344417115312458263622661053638328106171152657248665030646553428774841093901930704607536222323830652714219053258315203725973271888561008346423615263403247187378300091206842009223596217015587472233370894801414183441500718615204598597126312580207085587076603035353740651154509705013388670036319201682633010878676501472218856086428718160858012452623504181094346896177954376698418748732056754583388969344538258469123805829389256575587438028395767538856823010993087812097264132756253387201310757805260415962787707898397609109598269131540975221626904515164 # 第三次加密的c

# 使用中国剩余定理（CRT）求解同余方程组
# 首先，计算N = n1 * n2 * n3
N = n1 * n2 * n3

# 然后，分别计算N1, N2, N3
N1 = N // n1
N2 = N // n2
N3 = N // n3

# 计算N1_inverse, N2_inverse, N3_inverse
N1_inverse = int(gmpy2.invert(N1, n1))
N2_inverse = int(gmpy2.invert(N2, n2))
N3_inverse = int(gmpy2.invert(N3, n3))

# 使用CRT公式计算结果M
M = (c1 * N1 * N1_inverse + c2 * N2 * N2_inverse + c3 * N3 * N3_inverse) % N

# 计算M的立方根，即原始明文m
m = gmpy2.iroot(M, 3)[0]

# 将明文m转换回字节序列
plaintext = int.to_bytes(int(m), length=(m.bit_length() + 7) // 8, byteorder='big')

print("Recovered plaintext:", plaintext)
